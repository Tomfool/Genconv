}
close(rerun.sh)
}
sh.file <- "./Rerun_Suspicious.sh"
rerun.sh <- file(sh.file, "w+")
sh.prefix <- "sbatch -o suspicious-%j.out --mail-type=FAIL --mail-user=xji3@ncsu.edu"
# Dir gBGC MG94 Clock
colnames(Dir_gBGC_MG94_clock_summary)[(Dir_gBGC_MG94_clock_summary[13, ] < 1e-4)]
writeLines("#!/bin/bash", rerun.sh)
close(rerun.sh)
check.suspicious(sh.file, summary = Force_HKY_nonclock_summary, model = "HKY",clock = FALSE, gBGC = FALSE,
dir = FALSE, force = TRUE, threshold = 1e-1)
# for( pair in colnames(Dir_gBGC_MG94_clock_summary)[(Dir_gBGC_MG94_clock_summary[13, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_dir_gBGC_MG94_clock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_clock_dir_gBGC_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--no-force", "--gBGC", "--dir", "--clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
# # Dir gBGC MG94 nonClock
# colnames(Dir_gBGC_MG94_nonclock_summary)[(Dir_gBGC_MG94_nonclock_summary[13, ] < 1e-4)]
# for( pair in colnames(Dir_gBGC_MG94_nonclock_summary)[(Dir_gBGC_MG94_nonclock_summary[13, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_dir_gBGC_MG94_nonclock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_nonclock_dir_gBGC_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--no-force", "--gBGC", "--dir", "--no-clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
# # gBGC MG94 Clock
# colnames(gBGC_MG94_clock_summary)[(gBGC_MG94_clock_summary[12, ] < 1e-4)]
# for( pair in colnames(gBGC_MG94_clock_summary)[(gBGC_MG94_clock_summary[12, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_gBGC_MG94_clock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_clock_gBGC_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--no-force", "--gBGC", "--no-dir", "--clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
# # gBGC MG94 nonClock
# colnames(gBGC_MG94_nonclock_summary)[(gBGC_MG94_nonclock_summary[12, ] < 1e-4)]
# for( pair in colnames(gBGC_MG94_nonclock_summary)[(gBGC_MG94_nonclock_summary[12, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_gBGC_MG94_nonclock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_nonclock_gBGC_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--no-force", "--gBGC", "--no-dir", "--no-clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
# # Dir MG94 Clock
# colnames(Dir_MG94_clock_summary)[(Dir_MG94_clock_summary[12, ] < 1e-4)]
# for( pair in colnames(Dir_MG94_clock_summary)[(Dir_MG94_clock_summary[12, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_Dir_MG94_clock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_clock_dir_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--no-force", "--no-gBGC", "--dir", "--clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
# # Dir MG94 nonClock
# colnames(Dir_MG94_nonclock_summary)[(Dir_MG94_nonclock_summary[12, ] < 1e-4)]
# for( pair in colnames(Dir_MG94_nonclock_summary)[(Dir_MG94_nonclock_summary[12, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_dir_MG94_nonclock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_nonclock_dir_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--no-force", "--no-gBGC", "--dir", "--no-clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
# # MG94 Clock
# colnames(MG94_clock_summary)[(MG94_clock_summary[11, ] < 1e-4)]
# for( pair in colnames(MG94_clock_summary)[(MG94_clock_summary[11, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_MG94_clock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_clock_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--no-force", "--no-gBGC", "--no-dir", "--clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
# # MG94 nonClock
# colnames(MG94_nonclock_summary)[(MG94_nonclock_summary[11, ] < 1e-4)]
# for( pair in colnames(MG94_nonclock_summary)[(MG94_nonclock_summary[11, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_MG94_nonclock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_nonclock_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--no-force", "--no-gBGC", "--no-dir", "--no-clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
# # MG94 Force Clock
# colnames(Force_MG94_clock_summary)[(Force_MG94_clock_summary[11, ] < 1e-4)]
# for( pair in colnames(Force_MG94_clock_summary)[(Force_MG94_clock_summary[11, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_Force_MG94_clock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_clock_Force_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--force", "--no-gBGC", "--no-dir", "--clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
# # MG94 Force nonClock
# colnames(Force_MG94_nonclock_summary)[(Force_MG94_nonclock_summary[11, ] < 1e-4)]
# for( pair in colnames(Force_MG94_nonclock_summary)[(Force_MG94_nonclock_summary[11, ] < 1e-4)]){
#   paralog <- strsplit(pair, split = "_")[[1]]
#   pair.sh.name <- paste("./NewRun/", pair, "_Force_MG94_nonclock_suspicious.sh", sep = "")
#   pair.sh <- file(pair.sh.name, "w+")
#   sh.suffix <- paste(pair, "_nonclock_Force_suspicious_PrintScreen.txt", sep = "")
#   sh.txt <- paste("python", "Run_unfinished.py",
#                   "--paralog1", paralog[1], "--paralog2", paralog[2],
#                   "--force", "--no-gBGC", "--no-dir", "--no-clock", "--model", "MG94",
#                   ">", sh.suffix, sep = " ")
#   writeLines(c("#!/bin/bash", sh.txt), pair.sh)
#   close(pair.sh)
#   writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
# }
#
#
#
#
# close(rerun.sh)
check.suspicious(sh.file, summary = Dir_gBGC_MG94_clock_summary, model = "MG94",clock = TRUE, gBGC = TRUE,
dir = TRUE, force = FALSE, threshold = 1e-4)
check.suspicious(sh.file, summary = Dir_gBGC_MG94_clock_summary, model = "MG94",clock = TRUE, gBGC = TRUE,
dir = TRUE, force = FALSE, threshold = 1e-1)
View(Dir_gBGC_MG94_clock_summary)
check.suspicious(sh.file, summary = Dir_gBGC_MG94_clock_summary, model = "MG94",clock = TRUE, gBGC = TRUE,
dir = TRUE, force = FALSE, threshold = 1e-1)
sh.file <- "./Rerun_Suspicious.sh"
rerun.sh <- file(sh.file, "w+")
sh.prefix <- "sbatch -o suspicious-%j.out --mail-type=FAIL --mail-user=xji3@ncsu.edu"
writeLines("#!/bin/bash", rerun.sh)
close(rerun.sh)
# Dir gBGC MG94 Clock
check.suspicious(sh.file, summary = Dir_gBGC_MG94_clock_summary, model = "MG94",clock = TRUE, gBGC = TRUE,
dir = TRUE, force = FALSE, threshold = 1e-1)
summary = Dir_gBGC_MG94_clock_summary
model = "MG94"
clock = TRUE
gBGC = TRUE
dir = TRUE
force = FALSE
threshold = 1e-1
check.suspicious(sh.file, summary = Dir_gBGC_MG94_clock_summary, model = "MG94",clock = TRUE, gBGC = TRUE,
dir = TRUE, force = FALSE, threshold = 1e-1)
rerun <- file(sh.file, "a")
sh.prefix <- "sbatch -o suspicious-%j.out --mail-type=FAIL --mail-user=xji3@ncsu.edu"
sh.suffix <- "_"
if (dir) {
dir.cmd <- "--dir"
sh.suffix <- paste(sh.suffix, "dir_", sep = "")
} else {dir.cmd <- "--no-dir"}
if (gBGC) {
gBGC.cmd <- "--gBGC"
sh.suffix <- paste(sh.suffix, "gBGC_", sep = "")
} else gBGC.cmd <- "--no-gBGC"
paste(sh.suffix, model, "_", sep = "")
if (clock)  {
clock.cmd <- "--clock"
sh.suffix <- paste(sh.suffix, "clock_", sep = "")
}  else clock.cmd <- "--no-clock"
if (force) {
force.cmd <- "--force"
sh.suffix <- paste(sh.suffix, "force_", sep = "")
}  else force.cmd <- "--no-force"
idx <- which(rownames(summary) %in% "(N0,kluyveri)")
print(colnames(summary)[(summary[idx, ] < threshold)])
for( pair in colnames(summary)[(summary[idx, ] < threshold)]){
paralog <- strsplit(pair, split = "_")[[1]]
pair.sh.name <- paste("./NewRun/", pair, sh.suffix, "suspicious.sh", sep = "")
pair.sh <- file(pair.sh.name, "w+")
txt.suffix <- paste(pair, sh.suffix, "suspicious_PrintScreen.txt", sep = "")
sh.txt <- paste("python", "Run_unfinished.py",
"--paralog1", paralog[1], "--paralog2", paralog[2],
force.cmd, gBGC.cmd, dir.cmd, clock.cmd, "--model", model,
">", txt.suffix, sep = " ")
writeLines(c("#!/bin/bash", sh.txt), pair.sh)
close(pair.sh)
writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
}
close(rerun.sh)
idx
check.suspicious(sh.file, summary = Dir_gBGC_MG94_clock_summary, model = "MG94",clock = TRUE, gBGC = TRUE,
dir = TRUE, force = FALSE, threshold = 5e-1)
check.suspicious <- function(sh.file, summary, model, clock, gBGC, dir, force, threshold = 1e-4){
rerun <- file(sh.file, "a")
sh.prefix <- "sbatch -o suspicious-%j.out --mail-type=FAIL --mail-user=xji3@ncsu.edu"
sh.suffix <- "_"
if (dir) {
dir.cmd <- "--dir"
sh.suffix <- paste(sh.suffix, "dir_", sep = "")
} else {dir.cmd <- "--no-dir"}
if (gBGC) {
gBGC.cmd <- "--gBGC"
sh.suffix <- paste(sh.suffix, "gBGC_", sep = "")
} else gBGC.cmd <- "--no-gBGC"
sh.suffix <- paste(sh.suffix, model, "_", sep = "")
if (clock)  {
clock.cmd <- "--clock"
sh.suffix <- paste(sh.suffix, "clock_", sep = "")
}  else clock.cmd <- "--no-clock"
if (force) {
force.cmd <- "--force"
sh.suffix <- paste(sh.suffix, "force_", sep = "")
}  else force.cmd <- "--no-force"
idx <- which(rownames(summary) %in% "(N0,kluyveri)")
print(colnames(summary)[(summary[idx, ] < threshold)])
for( pair in colnames(summary)[(summary[idx, ] < threshold)]){
paralog <- strsplit(pair, split = "_")[[1]]
pair.sh.name <- paste("./NewRun/", pair, sh.suffix, "suspicious.sh", sep = "")
pair.sh <- file(pair.sh.name, "w+")
txt.suffix <- paste(pair, sh.suffix, "suspicious_PrintScreen.txt", sep = "")
sh.txt <- paste("python", "Run_unfinished.py",
"--paralog1", paralog[1], "--paralog2", paralog[2],
force.cmd, gBGC.cmd, dir.cmd, clock.cmd, "--model", model,
">", txt.suffix, sep = " ")
writeLines(c("#!/bin/bash", sh.txt), pair.sh)
close(pair.sh)
writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
}
close(rerun.sh)
}
sh.file <- "./Rerun_Suspicious.sh"
rerun.sh <- file(sh.file, "w+")
sh.prefix <- "sbatch -o suspicious-%j.out --mail-type=FAIL --mail-user=xji3@ncsu.edu"
writeLines("#!/bin/bash", rerun.sh)
close(rerun.sh)
# Dir gBGC MG94 Clock
check.suspicious(sh.file, summary = Dir_gBGC_MG94_clock_summary, model = "MG94",clock = TRUE, gBGC = TRUE,
dir = TRUE, force = FALSE, threshold = 5e-1)
source('~/.active-rstudio-document', echo=TRUE)
View(Dir_MG94_nonclock_summary)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
View(Dir_HKY_nonclock_summary)
View(Dir_gBGC_HKY_nonclock_summary)
summary = Dir_gBGC_HKY_nonclock_summary
model = "HKY"
clock = FALSE
gBGC = TRUE
dir = TRUE
force = FALSE
rerun <- file(sh.file, "a")
sh.prefix <- "sbatch -o suspicious-%j.out --mail-type=FAIL --mail-user=xji3@ncsu.edu"
sh.suffix <- "_"
if (dir) {
dir.cmd <- "--dir"
sh.suffix <- paste(sh.suffix, "dir_", sep = "")
} else {dir.cmd <- "--no-dir"}
if (gBGC) {
gBGC.cmd <- "--gBGC"
sh.suffix <- paste(sh.suffix, "gBGC_", sep = "")
} else gBGC.cmd <- "--no-gBGC"
sh.suffix <- paste(sh.suffix, model, "_", sep = "")
if (clock)  {
clock.cmd <- "--clock"
sh.suffix <- paste(sh.suffix, "clock_", sep = "")
}  else {
clock.cmd <- "--no-clock"
sh.suffix <- paste(sh.suffix, "nonclock_", sep = "")
}
if (force) {
force.cmd <- "--force"
sh.suffix <- paste(sh.suffix, "force_", sep = "")
}  else force.cmd <- "--no-force"
idx <- which(rownames(summary) %in% "(N0,kluyveri)")
print(colnames(summary)[(summary[idx, ] < threshold)])
idx
rownames(summary)
summary[12, ]
View(Dir_gBGC_HKY_nonclock_summary)
sh.file <- "./Rerun_Suspicious.sh"
rerun.sh <- file(sh.file, "w+")
writeLines("#!/bin/bash", rerun.sh)
close(rerun.sh)
rerun <- file(sh.file, "a")
sh.prefix <- "sbatch -o suspicious-%j.out --mail-type=FAIL --mail-user=xji3@ncsu.edu"
sh.suffix <- "_"
if (dir) {
dir.cmd <- "--dir"
sh.suffix <- paste(sh.suffix, "dir_", sep = "")
} else {dir.cmd <- "--no-dir"}
if (gBGC) {
gBGC.cmd <- "--gBGC"
sh.suffix <- paste(sh.suffix, "gBGC_", sep = "")
} else gBGC.cmd <- "--no-gBGC"
sh.suffix <- paste(sh.suffix, model, "_", sep = "")
if (clock)  {
clock.cmd <- "--clock"
sh.suffix <- paste(sh.suffix, "clock_", sep = "")
}  else {
clock.cmd <- "--no-clock"
sh.suffix <- paste(sh.suffix, "nonclock_", sep = "")
}
if (force) {
force.cmd <- "--force"
sh.suffix <- paste(sh.suffix, "force_", sep = "")
}  else force.cmd <- "--no-force"
idx <- which(rownames(summary) %in% "(N0,kluyveri)")
print(colnames(summary)[(summary[idx, ] < threshold)])
for( pair in colnames(summary)[(summary[idx, ] < threshold)]){
paralog <- strsplit(pair, split = "_")[[1]]
pair.sh.name <- paste("./NewRun/", pair, sh.suffix, "suspicious.sh", sep = "")
pair.sh <- file(pair.sh.name, "w+")
txt.suffix <- paste(pair, sh.suffix, "suspicious_PrintScreen.txt", sep = "")
sh.txt <- paste("python", "Run_unfinished.py",
"--paralog1", paralog[1], "--paralog2", paralog[2],
force.cmd, gBGC.cmd, dir.cmd, clock.cmd, "--model", model,
">", txt.suffix, sep = " ")
writeLines(c("#!/bin/bash", sh.txt), pair.sh)
close(pair.sh)
writeLines(paste(sh.prefix, pair.sh.name, sep = " "), rerun.sh)
}
close(rerun.sh)
}
```
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
View(Dir_MG94_nonclock_summary)
source('~/.active-rstudio-document', echo=TRUE)
View(Dir_MG94_nonclock_summary)
rm(list=ls())  # clean up workspace
setwd("/Users/xji3/Genconv/NewClusterPackRun")
path.HKY <- "/Users/xji3/FromCluster03232015_2/NewPackageNewRun/"
path.MG94 <- "/Users/xji3/FromCluster03212015/NewPackageNewRun/"
#path.HKY <- path.MG94
#path.MG94 = path.HKY
#path <- "G:/Geneconv/NewClusterPackRun/NewPackageNewRun/"
#HKY_clock_summary <- "HKY_clock_summary"
summary.list.MG94 <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"Force_MG94_clock_summary",
"Force_MG94_nonclock_summary"
)
summary.list.HKY <- c( "HKY_nonclock_summary",
"HKY_clock_summary",
"Force_HKY_clock_summary",
"Force_HKY_nonclock_summary"
)
#summary.list <- c("Force_MG94_clock_summary")
for (target.summary in summary.list.MG94){
summary_file <- paste(path.MG94, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
for (target.summary in summary.list.HKY){
summary_file <- paste(path.HKY, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
# read in directional model summary
summary.list.Dir <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.Dir){
summary_file <- paste(path.MG94, "Dir_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_", target.summary, sep = '')),
paste(path.MG94, "Dir_", target.summary, sep = ''))
}
# read in gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("gBGC_", target.summary, sep = '')),
paste(path.MG94, "gBGC_", target.summary, sep = ''))
}
# read in Dir gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "Dir_gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_gBGC_", target.summary, sep = '')),
paste(path.MG94, "Dir_gBGC_", target.summary, sep = ''))
}
View(Dir_MG94_nonclock_summary)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
summary.list.gBGC <- c(
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.HKY, "gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("gBGC_", target.summary, sep = '')),
paste(path.HKY, "gBGC_", target.summary, sep = ''))
}
# read in Dir gBGC model summary
summary.list.gBGC <- c(
"HKY_nonclock_summary",
"HKY_clock_summary"
)
View(Dir_gBGC_HKY_nonclock_summary)
View(Dir_HKY_nonclock_summary)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
View(HKY_clock_summary)
View(HKY_nonclock_summary)
View(Dir_HKY_nonclock_summary)
View(Dir_gBGC_HKY_clock_summary)
Dir_gBGC_HKY_clock_summary[10,]
View(gBGC_HKY_clock_summary)
Dir_gBGC_HKY_nonclock_summary[10,]
source('~/.active-rstudio-document', echo=TRUE)
View(HKY_nonclock_summary)
View(Dir_MG94_nonclock_summary)
View(Dir_gBGC_HKY_nonclock_summary)
