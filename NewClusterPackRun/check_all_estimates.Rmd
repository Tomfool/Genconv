---
title: "Check_all_estimates"
author: "Xiang Ji"
date: "May 8, 2015"
output: html_document
---

####This script is used for checking all estimates and possibly corrects some wrong MLE

```{r}
rm(list=ls())  # clean up workspace
setwd("/Users/xji3/Genconv/NewClusterPackRun")
path.04102015 <- '/Users/xji3/FromCluster05082015/NewPackageNewRun04102015/'
path.03232015.1 <- "/Users/xji3/FromCluster03232015/NewPackageNewRun/"
path.03232015.2 <- "/Users/xji3/FromCluster03232015_2/NewPackageNewRun/"
path.03232015.3 <- "/Users/xji3/FromCluster03232015_3/NewPackageNewRun/"
path.03232015.4 <- "/Users/xji3/FromCluster03232015_4/NewPackageNewRun/"
path.03212015 <- "/Users/xji3/FromCluster03212015/NewPackageNewRun/"
path.05082015 <- "/Users/xji3/FromCluster05082015/NewPackageNewRun/"
path.04172015 <- "/Users/xji3/FromCluster04172015/NewPackageNewRun/"
path.03232015 <- "/Users/xji3/FromCluster03232015/NewPackageNewRun/"
path.03192015 <- "/Users/xji3/FromCluster03192015/NewPackageNewRun/"
path.03182015 <- "/Users/xji3/FromCluster03182015/NewPackageNewRun/"
path.03172015 <- "/Users/xji3/FromCluster03172015/NewPackageNewRun/"
path.03162015 <- "/Users/xji3/FromCluster03162015/NewPackageNewRun/"
path.03112015 <- "/Users/xji3/FromCluster03112015/NewPackageNewRun/"
path.03102015 <- "/Users/xji3/FromCluster03102015/NewPackageNewRun/"
path.03092015 <- "/Users/xji3/FromCluster03092015/NewPackageNewRun/"
path.02192015 <- "/Users/xji3/FromCluster02192015/NewPackageNewRun/"
path.02112015 <- "/Users/xji3/FromCluster02112015/NewPackageNewRun/"
path.02062015 <- "/Users/xji3/02062015FromCluster/NewPackageNewRun/"
path.01272015 <- "/Users/xji3/FromCluster01272015/NewPackageNewRun/"
path.01262015 <- "/Users/xji3/FromCluster01262015/NewPackageNewRun/"
path.01162015 <- "/Users/xji3/FromCluster01162015/NewPackageNewRun/"
path.01122015 <- "/Users/xji3/0112FromCluster/NewPackageNewRun/"
path.12292014 <- "/Users/xji3/1229FromCluster/NewPackageNewRun/"

all.path <- c(
path.04102015,
path.03232015.1,
path.03232015.2,
path.03232015.3,
path.03232015.4,
path.03212015,
#path.05082015,
#path.04172015,
path.03232015,
path.03192015,
path.03182015
#path.03172015
#path.03162015  # The new generated MG94 clock for YDR502C_YLR180W is wrong with tau being 0
#path.03112015
#path.03102015,
#path.03092015,
#path.02192015,
#path.02112015,
#path.02062015,
#path.01272015,
#path.01262015,
#path.01162015,
#path.01122015,
#path.12292014)
)
obj <- -1e5
chosen.path <- path.03232015.1
pair <- "YLR333C_YGR027C"
summary.list <- c( 
  "HKY_nonclock_summary",
  "HKY_clock_summary",
  "Force_HKY_clock_summary", 
  "Force_HKY_nonclock_summary",
  "MG94_clock_summary",
  "MG94_nonclock_summary", 
  "Force_MG94_clock_summary", 
  "Force_MG94_nonclock_summary",
  "Dir_MG94_clock_summary",
  "Dir_MG94_nonclock_summary",
  "Dir_HKY_clock_summary",
  "Dir_HKY_nonclock_summary",
  "gBGC_MG94_clock_summary",
  "gBGC_MG94_nonclock_summary",
  "gBGC_HKY_clock_summary",
  "gBGC_HKY_nonclock_summary",
  "Dir_gBGC_MG94_clock_summary",
  "Dir_gBGC_MG94_nonclock_summary",
  "Dir_gBGC_HKY_clock_summary",
  "Dir_gBGC_HKY_nonclock_summary"
  )

prefix.list <- c( 
  "HKY_",
  "HKY_",
  "Force_HKY_", 
  "Force_HKY_",
  "MG94_",
  "MG94_", 
  "Force_MG94_", 
  "Force_MG94_",
  "Dir_MG94_",
  "Dir_MG94_",
  "Dir_HKY_",
  "Dir_HKY_",
  "gBGC_MG94_",
  "gBGC_MG94_",
  "gBGC_HKY_",
  "gBGC_HKY_",
  "gBGC_Dir_MG94_",
  "gBGC_Dir_MG94_",
  "gBGC_Dir_HKY_",
  "gBGC_Dir_HKY_"
  )

suffix.list <- c( 
  "_nonclock_summary",
  "_clock_summary",
  "_clock_summary", 
  "_nonclock_summary",
  "_clock_summary",
  "_nonclock_summary", 
  "_clock_summary", 
  "_nonclock_summary",
  "_clock_summary",
  "_nonclock_summary",
  "_clock_summary",
  "_nonclock_summary",
  "_clock_summary",
  "_nonclock_summary",
  "_clock_summary",
  "_nonclock_summary",
  "_clock_summary",
  "_nonclock_summary",
  "_clock_summary",
  "_nonclock_summary"
  )

# summary.list <- c( 
#   "MG94_nonclock_summary"
# )
# 
# prefix.list <- c( 
#   "MG94_"
#   )
# 
# suffix.list <- c( 
#    "_nonclock_summary"
#   )

to.path <- "/Users/xji3/MixedFromCluster/NewPackageNewRun/"
for (i in 1:length(summary.list)){
  summary <- summary.list[i]
  lnL.compare.mat <- NULL
  for (path in all.path){
    summary_file <- paste(path, summary, '.txt', sep = '')
    all <- readLines(summary_file, n = -1)
    if(length(all) > 0){
      col.names <- strsplit(all[1], ' ')[[1]][-1]
      row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
      summary_mat <- as.matrix(read.table(summary_file, 
                                          row.names = row.names, 
                                          col.names = col.names))
      if (path == path.04102015){
        default.lnL <- summary_mat[2, ]
        }
      assign(paste(summary, "_", gsub( "/N", "", substr(path, 24, 33)), sep = ""), summary_mat)  
      new.lnL <- default.lnL
      new.lnL[colnames(summary_mat)] <- summary_mat[2, ]
      }
    else{
      new.lnL <- default.lnL
      }
    lnL.compare.mat <- cbind(lnL.compare.mat, new.lnL)
    }  
  max.indices <- apply(lnL.compare.mat, 1, which.max)
  for (j in 1:length(max.indices)){
    file.copy(paste(all.path[max.indices[j]], prefix.list[i], rownames(lnL.compare.mat)[j], suffix.list[i], ".txt", sep = ""),
              paste(to.path, prefix.list[i], rownames(lnL.compare.mat)[j], suffix.list[i], ".txt", sep = ""))
    file.copy(paste(all.path[max.indices[j]], prefix.list[i], rownames(lnL.compare.mat)[j], 
                    gsub("_summary", "", suffix.list[i]), ".p", sep = ""),
              paste(to.path, prefix.list[i], rownames(lnL.compare.mat)[j], 
                    gsub("_summary", "", suffix.list[i]), ".p", sep = ""))
  }
  }


```