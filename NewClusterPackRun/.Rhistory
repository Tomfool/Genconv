path.MG94 = path.Hk
path.MG94 = path.HKY
path.HKY <- "/Users/xji3/Genconv/NewClusterPackRun/NewPackageNewRun/"
path.MG94 <- "/Users/xji3/FromCluster03172015/NewPackageNewRun/"
path.MG94 = path.HKY
for (target.summary in summary.list.MG94){
summary_file <- paste(path.MG94, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
(MG94_clock_summary - Force_MG94_clock_summary)[2,]
rm(list=ls())  # clean up workspace
path.HKY <- "/Users/xji3/Genconv/NewClusterPackRun/NewPackageNewRun/"
path.MG94 <- "/Users/xji3/FromCluster03172015/NewPackageNewRun/"
#path <- "G:/Geneconv/NewClusterPackRun/NewPackageNewRun/"
#HKY_clock_summary <- "HKY_clock_summary"
summary.list.MG94 <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"Force_MG94_clock_summary",
"Force_MG94_nonclock_summary"
)
summary.list.HKY <- c( "HKY_nonclock_summary",
"HKY_clock_summary",
"Force_HKY_clock_summary",
"Force_HKY_nonclock_summary"
)
#summary.list <- c("Force_MG94_clock_summary")
for (target.summary in summary.list.MG94){
summary_file <- paste(path.MG94, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
(MG94_clock_summary - Force_MG94_clock_summary)[2,]
MG94_clock_summary.new = MG94_clock_summary
Force_MG94_clock_summary.new = Force_MG94_clock_summary
path.MG94 = path.HKY
for (target.summary in summary.list.MG94){
summary_file <- paste(path.MG94, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
(MG94_clock_summary.new - MG94_clock_summary)[2,]
(Force_MG94_clock_summary.new - Force_MG94_clock_summary)[2,]
View(Force_MG94_clock_summary.new)
View(Force_MG94_clock_summary)
rownames(Force_MG94_clock_summary)
View(MG94_clock_summary)
View(MG94_clock_summary.new)
View(Force_MG94_clock_summary.new)
View(Force_MG94_clock_summary)
colnames(Force_MG94_clock_summary)[Force_MG94_clock_summary[10, ] < 1e-4]
rm(list=ls())  # clean up workspace
path.HKY <- "/Users/xji3/Genconv/NewClusterPackRun/NewPackageNewRun/"
path.MG94 <- "/Users/xji3/FromCluster03172015/NewPackageNewRun/"
#path <- "G:/Geneconv/NewClusterPackRun/NewPackageNewRun/"
#HKY_clock_summary <- "HKY_clock_summary"
summary.list.MG94 <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"Force_MG94_clock_summary",
"Force_MG94_nonclock_summary"
)
summary.list.HKY <- c( "HKY_nonclock_summary",
"HKY_clock_summary",
"Force_HKY_clock_summary",
"Force_HKY_nonclock_summary"
)
#summary.list <- c("Force_MG94_clock_summary")
for (target.summary in summary.list.MG94){
summary_file <- paste(path.MG94, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
for (target.summary in summary.list.HKY){
summary_file <- paste(path.HKY, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
# read in directional model summary
summary.list.Dir <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.Dir){
summary_file <- paste(path.MG94, "Dir_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_", target.summary, sep = '')),
paste(path.MG94, "Dir_", target.summary, sep = ''))
}
# read in gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("gBGC_", target.summary, sep = '')),
paste(path.MG94, "gBGC_", target.summary, sep = ''))
}
# read in Dir gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "Dir_gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_gBGC_", target.summary, sep = '')),
paste(path.MG94, "Dir_gBGC_", target.summary, sep = ''))
}
View(Dir_gBGC_MG94_clock_summary)
View(Dir_gBGC_HKY_clock_summary)
View(Dir_gBGC_MG94_clock_summary)
View(MG94_nonclock_summary)
View(gBGC_MG94_nonclock_summary)
View(Dir_MG94_clock_summary)
rm(list=ls())  # clean up workspace
path.HKY <- "/Users/xji3/Genconv/NewClusterPackRun/NewPackageNewRun/"
path.MG94 <- "/Users/xji3/FromCluster03182015/NewPackageNewRun/"
#path <- "G:/Geneconv/NewClusterPackRun/NewPackageNewRun/"
#HKY_clock_summary <- "HKY_clock_summary"
summary.list.MG94 <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"Force_MG94_clock_summary",
"Force_MG94_nonclock_summary"
)
summary.list.HKY <- c( "HKY_nonclock_summary",
"HKY_clock_summary",
"Force_HKY_clock_summary",
"Force_HKY_nonclock_summary"
)
#summary.list <- c("Force_MG94_clock_summary")
for (target.summary in summary.list.MG94){
summary_file <- paste(path.MG94, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
for (target.summary in summary.list.HKY){
summary_file <- paste(path.HKY, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
# read in directional model summary
summary.list.Dir <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.Dir){
summary_file <- paste(path.MG94, "Dir_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_", target.summary, sep = '')),
paste(path.MG94, "Dir_", target.summary, sep = ''))
}
# read in gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("gBGC_", target.summary, sep = '')),
paste(path.MG94, "gBGC_", target.summary, sep = ''))
}
# read in Dir gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "Dir_gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_gBGC_", target.summary, sep = '')),
paste(path.MG94, "Dir_gBGC_", target.summary, sep = ''))
}
same <- colnames(MG94_clock_summary) == colnames(Force_MG94_clock_summary)
same <- colnames(MG94_clock_summary)[colnames(MG94_clock_summary) == colnames(Force_MG94_clock_summary)]
# HKY
HKY.pair.names <- intersect(intersect(intersect(colnames(HKY_clock_summary),
colnames(HKY_nonclock_summary)),
colnames(Force_HKY_clock_summary)),
colnames(Force_HKY_nonclock_summary))
HKY.clock.filtered <- HKY_clock_summary[, HKY.pair.names]
HKY.nonclock.filtered <- HKY_nonclock_summary[, HKY.pair.names]
HKY.Force.clock.filtered <- Force_HKY_clock_summary[, HKY.pair.names]
HKY.Force.nonclock.filtered <- Force_HKY_nonclock_summary[, HKY.pair.names]
write.table(HKY.clock.filtered, paste( path.HKY, "HKY_clock_filtered", sep = ""))
write.table(HKY.nonclock.filtered, paste( path.HKY, "HKY_nonclock_filtered", sep = ""))
write.table(HKY.Force.clock.filtered, paste( path.HKY, "HKY_Force_clock_filtered", sep = ""))
write.table(HKY.Force.nonclock.filtered, paste( path.HKY, "HKY_Force_nonclock_filtered", sep = ""))
# MG94
MG94.pair.names <- intersect(intersect(intersect(colnames(MG94_clock_summary),
colnames(MG94_nonclock_summary)),
colnames(Force_MG94_clock_summary)),
colnames(Force_MG94_nonclock_summary))
MG94.clock.filtered <- MG94_clock_summary[, MG94.pair.names]
MG94.nonclock.filtered <- MG94_nonclock_summary[, MG94.pair.names]
MG94.Force.clock.filtered <- Force_MG94_clock_summary[, MG94.pair.names]
MG94.Force.nonclock.filtered <- Force_MG94_nonclock_summary[, MG94.pair.names]
write.table(MG94.clock.filtered, paste( path.MG94, "MG94_clock_filtered", sep = ""))
write.table(MG94.nonclock.filtered, paste( path.MG94, "MG94_nonclock_filtered", sep = ""))
write.table(MG94.Force.clock.filtered, paste( path.MG94, "MG94_Force_clock_filtered", sep = ""))
write.table(MG94.Force.nonclock.filtered, paste( path.MG94, "MG94_Force_nonclock_filtered", sep = ""))
(MG94.Force.clock.filtered - MG94.clock.filtered)[2, ]
View(MG94.Force.clock.filtered)
View(MG94.Force.clock.filtered)
View(MG94.nonclock.filtered)
View(MG94.Force.nonclock.filtered)
(MG94.Force.nonclock.filtered - MG94.nonclock.filtered)[2, ]
View(gBGC_MG94_clock_summary)
gBGC_MG94_clock_summary[8,]
Dir_MG94_clock_summary[8, ]
Dir_gBGC_MG94_clock_summary[8, ]
View(Dir_gBGC_MG94_clock_summary)
rm(list=ls())  # clean up workspace
path.HKY <- "/Users/xji3/Genconv/NewClusterPackRun/NewPackageNewRun/"
path.MG94 <- "/Users/xji3/FromCluster03192015/NewPackageNewRun/"
#path <- "G:/Geneconv/NewClusterPackRun/NewPackageNewRun/"
#HKY_clock_summary <- "HKY_clock_summary"
summary.list.MG94 <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"Force_MG94_clock_summary",
"Force_MG94_nonclock_summary"
)
summary.list.HKY <- c( "HKY_nonclock_summary",
"HKY_clock_summary",
"Force_HKY_clock_summary",
"Force_HKY_nonclock_summary"
)
#summary.list <- c("Force_MG94_clock_summary")
for (target.summary in summary.list.MG94){
summary_file <- paste(path.MG94, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
for (target.summary in summary.list.HKY){
summary_file <- paste(path.HKY, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
# read in directional model summary
summary.list.Dir <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.Dir){
summary_file <- paste(path.MG94, "Dir_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_", target.summary, sep = '')),
paste(path.MG94, "Dir_", target.summary, sep = ''))
}
# read in gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("gBGC_", target.summary, sep = '')),
paste(path.MG94, "gBGC_", target.summary, sep = ''))
}
# read in Dir gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "Dir_gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_gBGC_", target.summary, sep = '')),
paste(path.MG94, "Dir_gBGC_", target.summary, sep = ''))
}
View(MG94_clock_summary)
(MG94_clock_summary - Force_MG94_clock_summary)[2,]
View(Force_MG94_clock_summary)
(MG94_clock_summary - Force_MG94_clock_summary)[8,]
rm(list=ls())  # clean up workspace
path.HKY <- "/Users/xji3/Genconv/NewClusterPackRun/NewPackageNewRun/"
path.MG94 <- "/Users/xji3/FromCluster03192015/NewPackageNewRun/"
path.MG94 = path.HKY
#path <- "G:/Geneconv/NewClusterPackRun/NewPackageNewRun/"
#HKY_clock_summary <- "HKY_clock_summary"
summary.list.MG94 <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"Force_MG94_clock_summary",
"Force_MG94_nonclock_summary"
)
summary.list.HKY <- c( "HKY_nonclock_summary",
"HKY_clock_summary",
"Force_HKY_clock_summary",
"Force_HKY_nonclock_summary"
)
#summary.list <- c("Force_MG94_clock_summary")
for (target.summary in summary.list.MG94){
summary_file <- paste(path.MG94, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
for (target.summary in summary.list.HKY){
summary_file <- paste(path.HKY, target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(target.summary, summary_mat)
}
# read in directional model summary
summary.list.Dir <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.Dir){
summary_file <- paste(path.MG94, "Dir_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_", target.summary, sep = '')),
paste(path.MG94, "Dir_", target.summary, sep = ''))
}
# read in gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("gBGC_", target.summary, sep = '')),
paste(path.MG94, "gBGC_", target.summary, sep = ''))
}
# read in Dir gBGC model summary
summary.list.gBGC <- c(
"MG94_clock_summary",
"MG94_nonclock_summary",
"HKY_nonclock_summary",
"HKY_clock_summary"
)
for (target.summary in summary.list.gBGC){
summary_file <- paste(path.MG94, "Dir_gBGC_" , target.summary, '.txt', sep = '')
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
assign(paste("Dir_gBGC_", target.summary, sep = ''), summary_mat)
write.table(gsub("_", ".", paste("Dir_gBGC_", target.summary, sep = '')),
paste(path.MG94, "Dir_gBGC_", target.summary, sep = ''))
}
(MG94_clock_summary - Force_MG94_clock_summary)[2,]
(MG94_clock_summary - Force_MG94_clock_summary)[8,]
a = matrix(c(1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,1,), 6, 6)
a = matrix(c(1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,1), 6, 6)
a
a = matrix(c(1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,1), 6, 6, byrow = T)
a
rank(a)
rankMatrix(a)
library(Matrix)
a
rankMatrix(a)
crossprod(a)
rankMatrix(crossprod(a))
source('~/.active-rstudio-document', echo=TRUE)
View(lnL.mat)
hist(lnL.mat[,"MG94 codeml tree length"])
plot(lnL.mat[,"MG94 codeml tree length"])
write.table(lnL.mat[,"MG94 codeml tree length"], "/Users/xji3/MG94TreeLength")
